# Spiffe Verifiable Identity Document (SVID) test suite

The SVID is a subset of the X.509 specification that can be reliably and safely used by two SPIFFE services to mutually authenticate each other. The format of this certificate is [described publicaly elsewhere](https://github.com/spiffe/svid). For this certificate format to be useful, it is ideal if 
it can be correctly verified by (and, optionally, generated by) a wide range of TLS libraries.

This repository provides a test suite for generating and verifying SVIDs according to the public specification. It is useful both to verify that the specification as written is compatible with a range of TLS libraries, and as an exemplar codebase for generating these certificates.

Eventually, it is expected that this test suite will be merged with the SVID specification itself, so
that the two can be versioned in lock-step.

## Installing the test suite

Running this test suite will require:
* Docker (17.03.1-ce or higher reccomnded)

To install, clone this repository into a suitable location.

## Generating Certificates

First, you need to generate a set of SVIDs. To do this:

```
make -f generate/scripts/Makefile setup
make -f generate/scripts/Makefile build
make -f generate/scripts/Makefile generate
```

For more information, see [the documentation on certificate generation](generate/README.md)

## Running the test suite

To test that the certificates you just generated can actually be verified, run:

```
make -f verify/scripts/Makefile setup
make -f verify/scripts/Makefile build
make -f verify/scripts/Makefile verify
```

The output of this should be a report showing which tests succeeeded. For more information,
refer to [the documentation on the test suite](verify/README.md). 

## Cleaning up

To remove generated certificates, run:

```
make -f generate/scripts/Makefile clean_exited
make -f verify/scripts/Makefile clean_exited
```
